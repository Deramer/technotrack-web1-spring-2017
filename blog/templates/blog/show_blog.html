{% extends "core/base.html" %}
{% load static %}

{% block add_css %}
<link rel='stylesheet' href='{% static 'post_list.css' %}'>
{% endblock %}

{% block content %}
<h1>Posts in the blog "<a href='{% url 'blog:show_blog' blog.id %}'>{{ blog.title }}</a>"</h1>

{% if user.is_authenticated %}
<p><a href='{% url 'blog:create_post' blog.id %}'>Create new post!</a></p>
{% else %}
<p><a href='{% url 'core:login' %}'>Login</a> to create new post.</p>
{% endif %}

<p>Sort by <a href='?order=updated{% if order_desc_updated_at %}&order_way=asc{% endif %}'>updated</a>,
<a href='?order=title{% if order_desc_title %}&order_way=asc{% endif %}'>title</a></p>

<form method='get'>
	<input type='text' name='search' value='{{ search }}'>
	<input type='submit' value='Search'>
</form>

{% if posts %}
	{% for post in posts %}
	<div class='post'>
		<div class='post-header'>
			<a href='{% url 'blog:show_post' blog.id post.id %}'>"{{ post.title }}"</a>,
			creator {{ post.creator }},
			updated {{ post.updated_at }}
		</div>
		<div class='post-text'>
			{{ post.text | safe }}
		</div>
		<div class='post-footer'>
			<a href='{% url 'blog:show_post' blog.id post.id %}'>Read more</a>
		</div>
	</div>
	{% endfor %}
{% else %}
{% if search == '' %}
<p>There're no posts yet, be the first to add!</p>
{% else %}
<p>No posts found</p>
{% endif %}
{% endif %}
{% endblock %}
